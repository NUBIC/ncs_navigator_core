- title "Participants"

.mdes_table_definition
  = render 'documentation/participant'
  
.page_section.search
  = search_form_for @q do |f|
    
    = f.hidden_field :participant_person_links_relationship_code_eq
  
    = f.label :participant_person_links_person_last_name_cont, "Last Name"
    = f.text_field :participant_person_links_person_last_name_cont
    %br
    = f.label :participant_person_links_person_first_name_cont, "First Name"
    = f.text_field :participant_person_links_person_first_name_cont
    %br
    = f.label :p_id_cont, "Participant ID"
    = f.text_field :p_id_cont
    %br
    = f.submit "Search"


.page_section
  - if @participants.empty?
    #no_records
      No participants were found.
  - else
    .records_header
      .page_entries_info
        - model_name = (@participants.size == 1 ? "Participant" : "Participants")
        = raw page_entries_info @participants, {:model => model_name}
    %table.records
      %tr
        %th
          PSU
        %th
          = sort_link @q, "participant_person_links_person_first_name", "First Name"
        %th
          = sort_link @q, "participant_person_links_person_last_name", "Last Name"
        %th
          = sort_link @q, "p_id", "Participant ID"
        %th{ :colspan => "2" }

      - @participants.each do |participant|
        %tr{ :class => cycle('even_record', 'odd_record') }
          %td
            = participant.psu
          %td
            = participant.first_name
          %td
            = participant.last_name
          %td
            = participant.p_id
          %td
            = link_to 'View', participant_path(participant), :class => "show_link icon_link"
          %td
            = link_to 'Edit', edit_participant_path(participant), :class => "edit_link icon_link"

  = will_paginate @participants